# 小蓝 Club


# 知识库实习项目

## 如何实现百万数据从 Excel 导入数据库的？ #面过

[✅基于EasyExcel+线程池+批量插入实现百万级数据导入](https://www.yuque.com/hollis666/krcpbs/iekgungvgtyb06zh)

**整体流程**：对百万数据做一个划分，每一份数据做数据校验（唯一性检查），数据组装，入库

**技术选型**：在大文件读取方面，选用 EasyExcel 读取，因为它是流式读取，不会一次性把整个 Excel 都加载到内存中，而是逐行读取的，不会引起内存溢出

**性能问题**：
- 划分子任务，提交给线程池多线程导入
- 批量插入，比如用一个集合记录，每 1000 条插入一次，清空集合

**记录进度**：预先读出 Excel 总行数（EasyExcel 会读空行），用原子类记录已经入库的行数，更新数据库中文件导入记录的进度字段

**异常记录**：整体异常捕获后，在数据库中文件导入记录的异常信息字段中追加异常信息，并在 finally 中修改文件导入状态为异常






