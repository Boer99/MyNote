# 摘要

海洋锋是海洋中一种典型的地球物理现象，是鱼类和海洋哺乳动物的绿洲。准确的海洋锋面预报对渔业和航行安全至关重要。然而，海洋锋的形成和演变具有内在的非线性，并受到海流、风场和温度变化等多种因素的影响，这使得海洋锋的预测具有相当大的挑战性。

本研究提出了一种名为 Attention-ConvNet 的时间敏感网络来解决这一挑战。
海洋锋具有显著的多尺度特征，需要在不同的时间和空间尺度上进行分析和预测。
该网络设计了一个==层次化的注意力机制（HAM）==，有效地优先考虑相关的空间和时间信息，以满足特定的要求。
更重要的是，所提出的网络使用复杂的==分层分支卷积网络（HBCNet）架构==，这使得我们的网络能够利用空间和时间信息的互补优势，有效地捕捉海洋前沿的动态和复杂变化。
一般来说，网络优先考虑并关注锋动态的最相关信息，这确保了其有效预测海洋锋的能力。

外部实验表明，我们的网络显着优于传统方法，证实了其精确的海洋锋面预测能力。这些守则将在 https://github.com/yuhudeyue/Ocean-FrontPrediction-Model上公开提供 。

# 一. 引言

海洋锋面可以定义为水文特性水平梯度增强的相对狭窄区域，将不同垂直结构的更广泛区域分开。 对于鱼类和海洋哺乳动物来说，它就像海洋中的绿洲，因为它提高了浮游植物的生产力。 同时，由于水的密度，它对于船舶和潜艇来说可能是一个危险区域。 由于遥感图像的进步，从海面温度（SST）、海面叶绿素浓度或海面高度（SSH）可以看到大量典型的地球物理物体，例如锋面、沿海洪水和海冰。 ）图像 [1]、[2]、[3]。 热锋对于海洋生态系统[4]、渔业[5]、能量耗散[6]、气候变化[7]和水下声音传播[8]尤其重要。 它代表了限制海洋和大气之间能量和水分交换的关键地球物理参数。 此外，异常的海温与异常的自然现象有关，例如厄尔尼诺和拉尼娜，可能导致干旱、洪水和风暴等极端天气事件

到目前为止，人们在海洋前沿检测和识别方面已经开展了大量的研究工作[9]、[10]、[11]、[12]。 然而，对海洋前沿的探测和识别不足以让人类了解海洋生态系统并防范灾害。 准确预测海洋前沿的物理过程有利于渔业管理和极端天气预报。 不幸的是，海洋锋面具有充分发展的湍流（FDT）[13]的特性，即间歇性和多尺度特征，这使得精确的预测结果变得困难。

海洋锋（热锋）存在于水团交界处，温差明显。 前部区域通常营养丰富，能​​为海洋生物提供适宜的生存条件。 因此，锋区往往初级生产力较高，鱼类资源丰富。 准确的热锋探测对于海洋渔业和环境保护具有重要意义和价值。 从一系列海温图像中提取海洋前缘动态和趋势至关重要且有意义。 历史遥感海温可以表述为一种典型的时间序列数据。 遥感图像为它们的历史运动和物理过程提供了有力的证据。 
张等人[14]将 SST 预测表述为序列预测问题。他们研究了使用 LSTM 模型进行 SST 预测，并实现了超过 90%的预测准确率。
通常，海洋锋预测可以是 SST 预测的进一步步骤，即，将海洋锋探测直接应用于 SST 预报结果。但是，它把海洋锋的预测作为一个单独的事件，只有一个预测图像，这不能捕捉海洋锋的动态和趋势。这些结果对海洋锋的物理过程，特别是对海洋锋的突变缺乏解释。

在本文中，我们提出了一种注意力卷积网络来解决海洋锋预测问题。 与循环神经网络（RNN）及其变体相比，我们的方法设计了一个时空特征卷积模块，对海洋锋图像时间序列执行卷积。 与传统的卷积神经网络（CNN）相比，我们的模型引入了注意力机制，增强了模型决策过程的可解释性。 与传统的注意力机制不同，我们模型中的注意力模块旨在识别和优先考虑与海洋前沿演化最相关的信息。

我们提出的方法利用高分辨率时间序列图像数据、结构良好的嵌套多层架构、高效协调的多分支网络以及上下文特征加权方法来提取时空特征。 这种组合显着提高了模型解决具有挑战性的预测任务的能力。
为了增强预测过程的可解释性，我们首先通过卷积过程从单个遥感图像中学习空间层次结构。 它生成激活图来指示前沿理解的最重要区域，从而提供对模型决策的见解。
然后，我们提出了一种特殊的 LSTM 模块来捕获历史观测数据之间的长期依赖性，并通过 LSTM 存储单元的激活来揭示每个历史观测图像的贡献。 
此外，我们引入了一种注意力机制，通过在预测过程中关注特定的时间步长和海洋锋特征来增强模型的可解释性。 最后，我们结合卷积过程、LSTM 和注意力机制来理解和解释预测过程。

## 贡献

总的来说，这项工作的主要贡献可以总结如下。
- 1）我们设计了一个**时空卷积网络（spatial–temporal ConvNet, STConv）** 融合模块，用于全面表示海洋锋动态。 
- 2）我们设计了一个**分层注意机制（hierarchical attention mechanism, HAM）** 模块，用于识别和优先考虑与海洋锋演化最相关的信息。 
- 3）我们引入了**分层分支卷积网络（branching convolutional** **network, HBCNet）** 来准确可靠地预测海洋前沿。

# 二. 海洋锋研究的最新进展

科学家们已经针对海洋前沿开展了一系列探测、分类、预测等研究工作。 高效可靠的海洋锋检测可以为海洋锋分类和预测提供高质量的数据。 此外，前洋分类和预测可以使我们对前洋变化和演化有基本的了解。 本节将简要介绍海洋前沿相关的最新进展。

## A. 锋探测 

遥感图像为发现和预测锋面提供了新的见解和模式。 然而，海洋锋面的形成和演化受到海洋动力学、气象条件和环境变化等多种复杂因素的影响，使其预测变得非常复杂[13]。 

为了解决这个问题，Yang 等人[11]提出了两种有效的海洋锋检测方法，分别基于深度学习和微规范多尺度分形（MMF）模型。
- 他们应用傅立叶变换来获得海温图像的频域。 根据热锋具有强烈的温度变化的先验知识，可以确定热锋的位置。 此外，基于检测区域的上下文信息，使用小波变换来计算图像中每个点的奇异性指数。 

孙等人。 [10]提出了一种用于多尺度海洋锋检测和细粒度定位的深度神经网络框架。 他们的网络旨在学习海温图像与相应的海洋锋图像之间的映射关系。 该网络接受了历史海洋锋图像的训练。 在他们的模型中，可以通过重叠扫描来检测和定位海洋锋。 更重要的是，检测到的海洋锋可以自适应地转换为各种粒度的海洋锋，并通过比例加权融合成细粒度的海洋锋。 

这两种方法都已在极高分辨率遥感图像上进行了实验验证。 他们的研究为我们提供了两种有效的海洋锋检测解决方案。

---

最近，一些创新的建模方法被开发出来，以提高海洋锋检测模型的有效性和准确性：

Xing 等人。 [15]将反距离加权与数学形态学运算相结合，并展示了在检测沿海锋面、连接不连续锋面和减少重复检测方面的显着改进。 

同样，李等人[16]尝试在灰度 SST 图像上使用具有 U-Net 架构的深度学习模型来解决海洋锋提取中的混沌结果和虚假前沿的挑战。 该方法有效地识别并定位了重要的锋区。 

此外，费尔特等人[9] 能够直接从未经处理和未经辐射校正的卫星图像中检测海洋前沿。 这种方法显着增强了海洋锋检测的广度和及时性。 

朱等人[17]引入了一种渐进式融合注意力网络，其特点是具有侧分支结构的四阶段检测主干。 该方法可以有效促进多尺度海洋锋特征的提取和融合。

## B. 海洋锋分类

海洋锋形状不规则，存在时间不固定。 海洋锋形成的可能物理驱动力可分为两大类，一类与海气交换有关，另一类与非线性惯性效应和摩擦效应有关。 与海气交换相关的力包括行星和局部风应力、海面加热和冷却以及季节性水的蒸发和降水。 其他力包括河流的淡水输入、潮汐流和地表地转流的汇聚和剪切、海底地形和粗糙度引起的湍流混合、内波和内潮切变引起的湍流搅动以及湍流旋转引起的离心效应。

---

**根据强度，海洋锋可以方便地分为强锋和弱锋**。 一般来说，海洋锋越强，存在时间越长，拥有丰富鱼类资源的可能性就越高。 因此，洋锋分类对于海洋渔业具有重要意义。 

利马等人。 [18]提出使用 CNN 进行海洋锋分类。 具体来说，他们应用传输网络对海洋前沿进行分类，并对网络结构进行微调，以进一步提高分类性能。 最终，他们的方法可以实现高于 90% 的海洋锋分类准确率

**根据位置、强度和生命周期，海洋生命周期可分为增强阶段和衰减阶段两个演化阶段**

为了研究洋锋的演化，Yang 等人。 [12]提出了一种可以识别和跟踪海洋锋演化过程的深度神经网络。 特别是，他们的方法不仅可以准确地对海洋锋增强和衰减进行分类，还可以记录海洋锋位置变化。
- 更重要的是，海洋锋演化是一个新的研究领域。 ==洋锋演化包括但不限于增强和衰减过程==。 因此，滨海演化研究具有巨大的发展潜力。

## C. 锋预测 

在海洋科学中，科学家试图通过建立物理模型来了解前沿的演化机制。 区域海洋模型系统（ROMS）、混合坐标海洋模型（HYCOM）、欧洲海洋模型核心模型（NEMO）等经典海洋物理模型已成功应用于模拟海洋因子的演化和海洋污染物的输运。 海洋物质[19]，[20]。 这些模型可以利用数学公式模拟海洋锋的演变，从而具有较高的可解释性。 然而，这些数学公式涉及大量参数，需要设置准确的初始条件，由于目前技术的限制，很难获得。

---

幸运的是，近年来，数据驱动的人工智能技术，包括**支持向量回归（SVR）、RNN和长短期记忆（LSTM）** 被用来学习时间序列数据的规则[21]、[22]。 他们表现出了从时间序列数据中提取时空特征的强大能力[23]。 

具体来说，RNN 可以自动学习特定物理过程的演化规则，并已成功应用于农业[24]和气候[25]等各个研究领域。 已经提出了几种创新的建模方法来推进 SVR 在各种海洋学和环境应用中的应用：

Hu 等人。 [26]开发了一种使用 SVR 来估计表面海洋叶绿素 a 浓度的机器学习方法，从而提高了多个卫星传感器在全球范围内的跨传感器一致性。 

同样，郭等人。 [27] 使用 Landsat 和 MODIS 数据的遥感反射以及同步溶解氧 (DO) 测量和水温开发并验证了 SVR 模型，以估计休伦湖和其他内陆水体中的 DO，揭示了自 1984 年以来 DO 的空间和时间变化 确定影响长期溶解氧趋势的关键气候因素。 

在深度学习领域，Xiao 等人。 [28]提出了一种结合 LSTM 深度 RNN 和 AdaBoost 集成学习模型（LSTM-AdaBoost）的机器学习方法，以改进日常 SST 异常（SSTA）的短期和中期预测，表现出优于单个模型和其他比较方法的性能 在东海的一个案例研究中。 

进一步推进预测模型，Su 等人。 [29]提出了一种利用双向 LSTM（Bi-LSTM）神经网络结合海洋表面遥感观测和地下 Argo 网格数据来预测全球海洋地下温度和盐度异常的方法，与传统方法相比，具有更高的鲁棒性和泛化性。 

此外，Perou 和 Tian [30] 提出了一种深度学习方法，使用带有卷积 LSTM 单元的编码器-解码器网络来预测长达十天的海冰运动，利用过去的运动观测和卫星图像的光流，证明了其有效性和 相对于之前的深度学习方法的优越性。 

最后，周等人。 [31]提出了一种基于时空注意力增强 ConvLSTM 的网络，用于预测长达 7 天的海洋遥感反射率（Rrs），实现了优于其他模型的性能，并为藻华监测等海洋相关应用提供了关键支持。

---

海温变化是热锋的主要驱动因素。 代表性的数据驱动技术，如注意力机制[32]、图循环网络（GRN）[33]、图注意力网络（GAT）[34]和 RNN[35]，已成功应用于学习 SST 的模式 变体[36]、[37]、[38]、[39]。 

基于历史遥感海温影像，热锋预测可以通过两种方案实现。 

一是**对海温预测结果应用前线检测方法**。 更具体地说，该实现主要包括两个步骤，第一步是使用预测方法来预测 SST 图像系列，第二步是对预测结果应用检测方法来检测海洋锋。 

- 例如，张等人。 [14]将 SST 预测表述为 ==LSTM 模型的序列预测问题==，即使用先前的观察来预测未来[14]。 预测准确率达到 90%以上。 

- 然而，LSTM 无法充分利用 SST 数据的空间信息。 为了解决这一限制，FC-LSTM 和 CNN 组合（CFCC-LSTM）[40]通过将卷积核集成到 LSTM 中，对标准 LSTM 方法进行了改进。 
	- 该方法将海表温度数据视为==时空体==，显着提高了渤海的预测精度。 
	- 此外，CFCC-LSTM 将测试区域扩展到中国沿海地区，预测精度达到 98%以上。

另一种解决方案很简单，**直接对海洋锋图像系列应用预测方法**。 如前所述，海洋锋预测可以看作是海温预测的进一步发展。 

- 然而，多种驱动力的影响使海洋锋面的预测变得复杂，特别是当涉及到突然变化时。 为了解决这个问题，设计一种具体的预测方法并将其应用于海洋锋时间序列是一个值得尝试的研究方向。 为了准确可靠地预测海洋锋，本文研究了最先进的时间序列预测方法，并提出了海洋锋预测网络。 

- 实验结果表明，我们的海洋锋预测方法比 SVR [41]、LSTM [14]、卷积 LSTM (ConvLSTM) [42]、GAT [34] 以及 FC-LSTM 和 CNN 组合 (CFCC-LSTM) 更有效 ）[40]。


# 三． 提议的网络

海洋锋是两个不同水团之间的边界，涉及温度和盐度等物理特性。 在本文中，我们研究了在遥感海表温度图像中产生强烈温度梯度的热锋。 通常，热锋区域的最小温度变化通常为 0.5 ℃。 然而，最小温度变化也可以根据特定条件而变化。 

当前，海洋锋预测是海洋学领域的一个关键科学问题。 大量的研究工作是利用遥感进行的，以发现其内在的结构和动力学[43]。 

海洋前沿的变化本质上代表了海洋的时间动态。 因此，从遥感图像分析的角度来看，它可以被视为时空预测的具体挑战。 

传统的时间序列预测模型，包括 LSTM，会遇到 3D 属性和额叶区域之间的地理相互依赖性的障碍。

---

为了解决上述问题，本文提出了一种新颖的 Attention-ConvNet 网络来并行提取空间和时间信息。 

如图 1 所示，所提出的网络可以分为两个重要的模块。
- STConv 模块如图 1 所示，应用空间卷积网络（Spatial ConvNet）和 HBCNet 从海洋锋时间序列中提取 3D 特征。 
- HAM 模块设计了三个注意力层，使网络专注于学习海洋锋特征。 

第 III-A 节和第 III-B 节详细介绍了空间 ConvNet、HBCNet 和 HAM

## A. Spatial–Temporal ConvNet Fusion


为了从历史海洋锋数据集中提取海洋锋演化的显着特征，所提出的卷积架构集成了空间 ConvNet 和 HBCNet，并将结果输入到 HAM 模块的不同层。

---

可以看出，海洋前缘在遥感图像中是一个地理带状区域。 因此，捕捉空间特征对于前方检测和识别至关重要。 

Spatial ConvNet 是我们网络的重要组成部分之一，主要侧重于提取空间特征。 它使用 5 维张量处理 3 维空间数据，包括批量大小、通道、图像宽度、图像高度和时间序列长度。 

> Spatial ConvNet 的具体结构 ↓↓↓↓↓

Spatial ConvNet ==分别在每个通道上执行卷积，然后对所有通道的结果进行求和==。 
- 由于 ConvNet 的局部感受野和权重共享特性，可以很好地捕捉 <font color="#ff0000">海洋锋水细胞?？</font>之间的结构依赖性。 
- 此外，Spatial ConvNet 还==捕获附近帧的时间信息==，将其用作细粒度海洋锋检测和定位的上下文信息。

---

科学家们更关心的是海洋锋面的进化，而不是探测。==历史海面记录的顺序性==为我们提供了了解其变化和演化以进行预测的机会。我们提出了 HBCNet 作为对空间 ConvNet 的并行补充，如图 1 所示。

通常，LSTM 是时间序列预测的直接方法。然而，它只==为二维时间序列==数据而设计。历史海面演变数据为时间序列图像帧。因此，我们的 HBCNet 采用了复杂的多层和多分支结构来丰富对时间序列图像数据的特征提取能力。

> HBCNet 的具体结构 ↓↓↓↓↓

具体地说，HBCNet 包括三个分支，每个分支包括两个 LSTM 层，伴随着两个不同窗口大小的卷积层。
- 我们==用卷积运算代替了传统的 LSTM 矩阵乘法运算==。该方法的优点是能够提取海面三维结构中随时间演化的固有空间特征。

最后，这些分支的输出通过级联进行聚合，如图 1 所示。

---

#todo LSTM 公式部分

---

Spatial ConvNet 和 HBCNet 都能有效地从 3D 海洋锋时间序列中提取时空特征。 尽管它们具有固有的相似性，但这两种架构的目的却有所不同。 
- 例如，空间卷积网络增强了通过时间序列帧上下文捕获结构特征的能力。 
- 同时，HBCNet 作为趋势预测的时间特征提取的有效机制。

时空特征的融合强调了提取的特征同时用于海洋锋识别和预测的能力。 我们在第五节中进行了消融实验，以展示每个模块的性能。

## B. Hierarchical Attention Mechanism

遥感图像的覆盖范围可达数百公里。 然而，海岸线的长度只有几十公里，宽度则短得多。 因此，我们更应该关注如何准确定位前方。 如何让 AI 模型聚焦海洋重要或关键区域，对于海滨识别和预测至关重要。 

注意力机制已成为深度学习界最突出的思想之一。 一些基于注意力的神经网络已经在各个领域展示了成功的应用，例如图像分类[44]、[45]和信任评估[46]。 

在这项工作中，我们设计了一个特定的==三层注意力模块==，旨在提取精细的海滨特征。 

我们的 HAM 模块的输入数据也是 3D 时间序列图像，如图 2 所示。时间维度表示海洋前沿随时间的变化。 同时，海滨图像同时展现了区域和全球的海滨特征，这些特征在垂直和水平维度上得到体现。 特别是，我们的 HAM 模块允许网络从 STConv 模块预测的时间序列中独立搜索海滨特征。 

图 2 显示了所提出的 HAM 模块的结构。 具体来说，我们的 HAM 模块包括==具有不同输入的三个注意力层==，如图 1 和 2 所示。 1 和 2。我们的 HAM 模块的输入数据是海滨时间序列以及从 Spatial ConvNet 和 HBCNet 中提取的相应特征。 海滨时间序列 X = Series(t, L) 表示从时间步 t 开始的海滨时间序列。 Nettemp 表示 HBCNet 提取的海滨时间特征，Netspat 表示 Spatial ConvNet 提取的海滨空间特征。

---

#todo 

---

在本研究中，我们使用==平方误差==作为损失函数

# 四. 实验

## A. 数据和地理区域

为了验证和评估模型性能，我们引入了来自两个典型地理区域的数据集，即==黑潮数据集和渤海数据集==，如图 3 所示。

黑潮数据集包含 ==15 年==的每日海表温度图像[11]，这些图像是由 Advanced 捕获的 甚高分辨率辐射计 (AVHRR)。 黑潮海温
- 时间序列范围为 2007 年至 2021 年，
- 分辨率为 0.05°，约 5 公里。 

渤海数据集包含 ==30 多年==的日常海表温度图像。 渤海海温
- 时间序列[14]范围为 1981 年至 2016 年，
- 分辨率为 0.25°，约 25 km。

---

==渤海是内海，对海陆水循环具有重要意义==。 渤海数据集如图 3 所示，覆盖纬度 37.56 至 40.51N、经度 117.85 至 120.85E 的区域，数据集的每幅图像的尺寸为 13×13 像素。 

==黑潮洋流是世界第二大洋流，流速快、流量大，从低纬度到中纬度地区输送大量的质量和能量（如热量）==[47]。 我们选择黑潮系统的一个活跃区域作为我们的实验区。 黑潮数据集如图 3 所示，覆盖纬度 21.8 至 24.25N、经度 124.3 至 126.75E 的区域，数据集的每张图像的尺寸为 50×50 像素。

---

在本文中，我们构建了一个用于海滨预测的人工智能网络，该网络应该使用标记数据进行训练。 正如最近的前沿检测[9]、[10]和识别[12]、[18]工作中所建议的，我们使用 MMF 模型[11]生成渤海和黑潮海滨数据集。 MMF 利用 SST 图像中的局部梯度来检测像素强度的变化。 MMF 的一个关键组成部分是奇异指数 (SE) 的精确计算，这是使用 Pont 等人提出的数值稳健方法计算的。 [48]。 SE 值的一小部分对应于 SST 图像中温度变化最显着的区域，这表明存在海洋锋面 [49]。 为了识别这些重要前沿，应用了阈值。 该阈值是根据 SST 图像的像素密度仔细确定的，并且根据专家知识，密度通常设置为小于 20%。 在本研究中，我们将像素密度设置为 20%，选择最高的 20% SE 值来描绘海滨。

---

模型训练中训练集和测试集之间的典型比例是分配 80% 的数据用于训练目的，保留剩余的 20% 用于测试 [50]。 这样的比例可以作为各种机器学习任务的合理起点，但最近的研究结果表明，对测试集使用不同的配置可能会提高模型训练的性能[41]。 

在我们的应用程序中，我们使用不同的测试集结构（例如，75/25、80/20）。 具体来说，75%的渤海海滨数据集用于训练所提出的网络，另外 25%用于评估模型性能。 大约 80% 的黑潮海滨数据集用于训练所提出的网络，另外 20% 用于评估模型性能。 

我们的数据集与其他数据集的区别在于图像是随时间排序的，这使得它们成为时间序列数据集。 此外，我们的数据集提供了有关海洋前沿的空间定位、独特特征和上下文相关性的详细信息，从而有助于更准确地理解模型的预测任务。 相比之下，其他数据集可能仅提供原始数据，缺乏从海滨检测中得出的具体注释，从而阻碍了模型对海滨的感知和解释能力。

---

与黑潮系统内观察到的显着波动和剧烈变化相比，渤海内的海滨动态全年表现出一致的时间变化。 

为了全面评估所提出的海滨预测网络的性能，我们在这些不同的区域进行了充分的比较和评估实验。 

海洋锋面所在的区域营养丰富，为多种海洋生物的繁衍生息创造了有利的环境。值得注意的是，这些海滨地区可能拥有丰富的鱼类资源[51]。 因此，海滨预测的前景显示出提高捕捞效率的重大前景，从而为海洋渔业带来巨大效益。

## B. 评估指标

F1-Score



